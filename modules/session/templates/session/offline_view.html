{% extends "core/base.html" %}
{% load static %}

{% block title %}Offline View - {{ session.title|default:"Saved Session" }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'session/css/offline_view.css' %}">
{% endblock %}

{% block content %}
<div class="main offline-container">
  <div class="offline-header">
    <h1>{{ session.title|default:"Saved Session" }}</h1>
    <p class="subtitle">View-only mode (offline snapshot)</p>
  </div>

  {% if snapshot_url %}
  <!-- Toolbar -->
  <div class="offline-toolbar" role="toolbar" aria-label="Snapshot controls">
    <div class="toolbar-left">
      <button id="zoomOutBtn" class="btn btn-secondary" aria-label="Zoom out" title="Zoom Out (−)">−</button>
      <span id="zoomLevel" class="zoom-level" role="status" aria-live="polite">100%</span>
      <button id="zoomInBtn" class="btn btn-secondary" aria-label="Zoom in" title="Zoom In (+)">+</button>
      <button id="resetZoomBtn" class="btn btn-secondary" aria-label="Reset zoom" title="Reset (0)">Reset</button>
    </div>
    <div class="toolbar-right">
      <button id="downloadBtn" class="btn btn-secondary" aria-label="Download image" title="Download">Download</button>
      <button id="printBtn" class="btn btn-secondary" aria-label="Print snapshot" title="Print">Print</button>
      <button id="copyLinkBtn" class="btn btn-secondary" aria-label="Copy link" title="Copy Link">Copy Link</button>
    </div>
  </div>
  {% endif %}

  <div class="snapshot-frame">
    {% if snapshot_url %}
      <div id="snapshotViewport" class="snapshot-viewport" aria-label="Snapshot viewport">
        <div id="snapshotSkeleton" class="snapshot-skeleton" aria-hidden="true"></div>
        <img id="snapshotImage"
             src="{{ snapshot_url }}"
             alt="Whiteboard Snapshot"
             class="snapshot-image"
             loading="lazy">
      </div>
    {% else %}
      <p class="no-snapshot" role="status" aria-live="polite">No saved snapshot available for this session.</p>
    {% endif %}
  </div>

  <div class="offline-back">
    <a href="{% url 'saved_sessions' %}" class="btn btn-secondary">← Back to Saved Sessions</a>
  </div>
</div>

{% if snapshot_url %}
<script src="{% static 'session/js/offline_view.js' %}"></script>
{% endif %}
{% endblock %}
